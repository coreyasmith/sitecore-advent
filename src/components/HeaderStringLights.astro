---
interface Props {
  glow?: boolean;
}

// Enabled only for home page
const glow = Astro.props.glow ?? false;

const colors = [
  { hex: '#ff3b30', rgb: '255,59,48' },
  { hex: '#ff9500', rgb: '255,149,0' },
  { hex: '#ffd60a', rgb: '255,214,10' },
  { hex: '#34c759', rgb: '52,199,89' },
  { hex: '#5ac8fa', rgb: '90,200,250' },
  { hex: '#007aff', rgb: '0,122,255' },
  { hex: '#5856d6', rgb: '88,86,214' },
  { hex: '#ff2d55', rgb: '255,45,85' },
  { hex: '#34a853', rgb: '52,168,83' },
  { hex: '#00c7be', rgb: '0,199,190' },
  { hex: '#ff6bcb', rgb: '255,107,203' },
  { hex: '#a284ff', rgb: '162,132,255' },
];

const lights = [...colors, ...colors];
---

<div class={`string-lights ${glow ? 'glow-enabled' : ''}`} aria-hidden="true">
  <ul class="lights">
    {
      lights.map((color, i) => (
        <li
          style={`--c:${color.hex}; --rgb:${color.rgb}; --i:${(i % colors.length) * 0.15};`}
        />
      ))
    }
  </ul>
</div>

<style>
  .string-lights {
    position: absolute;
    left: 0;
    right: 0;
    bottom: -30px;
    height: 48px;
    pointer-events: none;
  }
  .lights {
    width: 100%;
    padding: 0 1rem;
    margin: 0;
    display: flex;
    justify-content: space-between;
    list-style: none;
  }
  .lights li {
    position: relative;
    width: 14px;
    height: 18px;
    margin-top: 6px;
    display: block;
    transform-origin: center top;
    animation: sway 3.6s ease-in-out infinite;
    animation-delay: calc(var(--i) * 1s);
  }
  .lights li:after {
    content: "";
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 0;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--c);
    box-shadow:
      0 0 10px rgba(var(--rgb), 0.35),
      0 0 28px rgba(var(--rgb), 0.12);
    border: 1px solid rgba(0, 0, 0, 0.12);
    animation-duration: calc((rem(calc(var(--i)/0.15 + 6), 12)) * 0.4s + 3.0s);
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    animation-delay: calc(var(--i) * 0.2s);
  }
  .glow-enabled .lights li:after {
    animation-name: glow;
  }
  .lights li:nth-child(odd) {
    animation-duration: 4s;
  }
  .lights li:nth-child(even) {
    animation-duration: 3.2s;
  }

  @keyframes glow {
    0%, 100% {
      background: color-mix(in srgb, var(--c) 50%, black 50%);
      box-shadow:
        0 0 10px rgba(var(--rgb), 0),
        0 0 28px rgba(var(--rgb), 0);
    }
    50% {
      background: var(--c);
      box-shadow:
        0 0 10px rgba(var(--rgb), 0.35),
        0 0 28px rgba(var(--rgb), 1);
    }
  }
  @keyframes sway {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(2px);
    }
  }
  @media (max-width: 768px) {
    .lights {
      gap: 6px;
      padding: 0 0.5rem;
    }
    .lights li {
      width: 12px;
      height: 16px;
      display: none;
    }
    .lights li:nth-child(2n) {
      display: block;
    }
  }
</style>
